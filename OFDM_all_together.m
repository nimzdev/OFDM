SNR_db=-20:1:40;
Error1=[0.497851851851852	0.498059259259259	0.496449074074074	0.496132407407407	0.496475000000000	0.496161111111111	0.494925000000000	0.494191666666667	0.493159259259259	0.493014814814815	0.492447222222222	0.491237037037037	0.490175000000000	0.489016666666667	0.487284259259259	0.486084259259259	0.485788888888889	0.482508333333333	0.481567592592593	0.478055555555556	0.476071296296296	0.473507407407407	0.470623148148148	0.466336111111111	0.462927777777778	0.457970370370370	0.453437962962963	0.447875925925926	0.441341666666667	0.434282407407407	0.426597222222222	0.417562962962963	0.408016666666667	0.397072222222222	0.385514814814815	0.372214814814815	0.357919444444444	0.341916666666667	0.323786111111111	0.306084259259259	0.286430555555556	0.265397222222222	0.243765740740741	0.222069444444444	0.199100000000000	0.177150000000000	0.155687037037037	0.135339814814815	0.115522222222222	0.0979972222222222	0.0819000000000000	0.0682000000000000	0.0560935185185185	0.0462194444444444	0.0376462962962963	0.0302842592592593	0.0245620370370370	0.0196166666666667	0.0157435185185185	0.0124611111111111	0.0101629629629630];
Error2=[0.460465740740741	0.455258333333333	0.450346296296296	0.444856018518519	0.438562500000000	0.431983796296296	0.424060185185185	0.415797685185185	0.406153703703704	0.396856944444444	0.385311574074074	0.373511574074074	0.360699537037037	0.346693055555556	0.332194444444444	0.315260648148148	0.298744907407407	0.280287962962963	0.261368518518519	0.241853703703704	0.221362962962963	0.200411574074074	0.178449537037037	0.157965277777778	0.137006481481481	0.116892592592593	0.0977287037037037	0.0797328703703704	0.0634546296296296	0.0490291666666667	0.0368101851851852	0.0264916666666667	0.0186703703703704	0.0121041666666667	0.00754583333333333	0.00449953703703704	0.00247175925925926	0.00124490740740741	0.000578240740740741	0.000244444444444444	9.58333333333333e-05	2.77777777777778e-05	7.87037037037037e-06	1.38888888888889e-06	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0];
Error3=[0.492945370370370	0.492251851851852	0.490848148148148	0.489752777777778	0.488870370370370	0.486754629629630	0.486450000000000	0.483518518518519	0.482276851851852	0.479038888888889	0.476556481481482	0.474325925925926	0.471405555555556	0.466887037037037	0.463889814814815	0.458600000000000	0.453953703703704	0.448866666666667	0.442583333333333	0.436244444444444	0.427996296296296	0.418596296296296	0.409537962962963	0.399674074074074	0.387468518518519	0.374619444444444	0.360733333333333	0.344612962962963	0.328502777777778	0.310459259259259	0.290587037037037	0.270987962962963	0.249811111111111	0.226420370370370	0.205172222222222	0.182906481481481	0.161217592592593	0.140022222222222	0.120101851851852	0.101791666666667	0.0861694444444445	0.0706796296296296	0.0577611111111111	0.0463370370370370	0.0374898148148148	0.0294018518518519	0.0231370370370370	0.0180935185185185	0.0141361111111111	0.0110018518518519	0.00839907407407407	0.00632777777777778	0.00511111111111111	0.00390277777777778	0.00292407407407407	0.00231203703703704	0.00180555555555556	0.00137407407407407	0.00114629629629630	0.000863888888888889	0.000702777777777778];
Error4=[0.492376851851852	0.492103703703704	0.490251851851852	0.489681481481482	0.488743518518519	0.486566666666667	0.485350000000000	0.482564814814815	0.482304629629630	0.479123148148148	0.477266666666667	0.473839814814815	0.470463888888889	0.466181481481482	0.463027777777778	0.457862037037037	0.452486111111111	0.446964814814815	0.442085185185185	0.434578703703704	0.425790740740741	0.417564814814815	0.408233333333333	0.397637962962963	0.384121296296296	0.372137037037037	0.357288888888889	0.342325925925926	0.325950000000000	0.306278703703704	0.287016666666667	0.266014814814815	0.244237962962963	0.223001851851852	0.201345370370370	0.179375000000000	0.157579629629630	0.136869444444444	0.117957407407407	0.100475000000000	0.0842462962962963	0.0703768518518519	0.0581768518518519	0.0471935185185185	0.0387481481481482	0.0315259259259259	0.0252537037037037	0.0200018518518519	0.0159935185185185	0.0129166666666667	0.00991388888888889	0.00796574074074074	0.00634722222222222	0.00507222222222222	0.00395000000000000	0.00314722222222222	0.00259259259259259	0.00205462962962963	0.00161296296296296	0.00130000000000000	0.00107685185185185];
Error5=[0.493389814814815	0.492929629629630	0.492050000000000	0.491264814814815	0.489337962962963	0.488460185185185	0.487055555555556	0.485133333333333	0.484193518518519	0.481456481481481	0.479254629629630	0.476634259259259	0.473910185185185	0.470569444444444	0.467238888888889	0.462387962962963	0.458543518518519	0.453799074074074	0.447977777777778	0.442046296296296	0.434578703703704	0.426451851851852	0.417943518518519	0.408774074074074	0.398004629629630	0.385525925925926	0.373208333333333	0.358450925925926	0.342915740740741	0.325777777777778	0.307554629629630	0.288992592592593	0.268162037037037	0.247700925925926	0.225309259259259	0.203412962962963	0.182205555555556	0.160820370370370	0.140569444444444	0.121486111111111	0.103962962962963	0.0886305555555556	0.0745657407407407	0.0624805555555556	0.0520537037037037	0.0430759259259259	0.0354694444444444	0.0289592592592593	0.0238712962962963	0.0198064814814815	0.0158675925925926	0.0130453703703704	0.0105731481481481	0.00870277777777778	0.00702037037037037	0.00573425925925926	0.00472129629629630	0.00392314814814815	0.00325740740740741	0.00269444444444444	0.00222870370370370];
figure(1)
semilogy(SNR_db,Error1,'-o',SNR_db,Error2,'-o',SNR_db,Error3,'-o',SNR_db,Error4,'-o',SNR_db,Error5,'-*')
grid on
title('The BER Performance of BPSK OFDM');
ylabel('Bit Error Rate')
xlabel('E_b/\eta in dB');
legend({'Waterfilling(Q5)','MRC Diversity Rx=10(Q6)','Zf (Q7)','MMSE without cliping (Q7)','MMSE with cliping (Q8)'},'FontSize',12)
